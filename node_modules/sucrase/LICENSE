//
// Copyright (C) Microsoft. All rights reserved.
//

define(() => {
    class ScoobeAccountState {
        launchAsync() {
            // Block non-supported account types such as secondary MSA, Domain joined, AAD connected accounts, Guest acoounts etc. from going through the SCOOBE flow
            let items = ["MsaPrimaryAccount"];
            return CloudExperienceHost.AccountAndServices.getUserProfileEngagementAsync(items).then(function (itemResults) {
                if (itemResults[0] === "Ineligible") {
                    return WinJS.Promise.as(CloudExperienceHost.AppResult.cancel);
                }
                // Call getContextParameterProperties to get the account and ngc state.
                return CloudExperienceHost.MSA.getContextParameterProperties().then(function (propertySet) {
                    // ShouldSkipNGCEnroll.getShouldSkipAsync will call NgcQueryEnabled to check whether or not Ngc is disabled for provision.
                    return CloudExperienceHost.MSA.ShouldSkipNGCEnroll.getShouldSkipAsync().then(function (isNgcDisabled) {

